<div class="subadmins-container">
	<!-- Header -->
	<div class="page-header">
		<div class="header-content">
			<div class="header-text">
				<h1>Encargados de Sucursal</h1>
				<p>Gestión de usuarios con permisos de enc. sucursal</p>
			</div>

			<!-- Campo de búsqueda -->
			@if (hasSubadmins) {
			<div class="search-container">
				<mat-icon class="search-icon">search</mat-icon>
				<input type="text" class="search-input" placeholder="Buscar por nombre o documento..."
					[(ngModel)]="searchText">
			</div>
			}
		</div>
	</div>

	<!-- Contenido Principal -->
	<div class="content-wrapper">
		@if (hasSubadmins) {
		<!-- Tabla de Encargados de Sucursal -->
		<div class="table-container">
			<div class="table-responsive">
				<table mat-table [dataSource]="subadmins | subadminFilter: searchText" class="custom-table">
					<!-- Columna Nombre Completo -->
					<ng-container matColumnDef="name">
						<th mat-header-cell *matHeaderCellDef>Nombre Completo</th>
						<td mat-cell *matCellDef="let subadmin">
							<div class="user-info">
								<div class="user-name">{{ subadmin.name }} {{ subadmin.lastName }}</div>
								<div class="user-email">{{ subadmin.email }}</div>
							</div>
						</td>
					</ng-container>

					<!-- Columna Teléfono -->
					<ng-container matColumnDef="phone">
						<th mat-header-cell *matHeaderCellDef>Teléfono Celular</th>
						<td mat-cell *matCellDef="let subadmin">
							<div class="phone-info">
								<mat-icon>phone</mat-icon>
								{{ subadmin.phone }}
							</div>
						</td>
					</ng-container>

					<!-- Columna Sucursal -->
					<ng-container matColumnDef="branch">
						<th mat-header-cell *matHeaderCellDef>Sucursal Asignada</th>
						<td mat-cell *matCellDef="let subadmin">
							<div class="branch-info">
								<mat-icon>store</mat-icon>
								{{ subadmin.branch }}
							</div>
						</td>
					</ng-container>

					<!-- Columna Acciones -->
					<ng-container matColumnDef="actions">
						<th mat-header-cell *matHeaderCellDef>Acciones</th>
						<td mat-cell *matCellDef="let subadmin">
							<button mat-raised-button class="view-btn" (click)="viewDetails(subadmin)">
								<mat-icon>visibility</mat-icon>
								Ver Detalles
							</button>
						</td>
					</ng-container>

					<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
					<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
				</table>
				<!-- Mensaje cuando no hay resultados -->
				<div class="no-results" *ngIf="(subadmins | subadminFilter: searchText).length === 0 && searchText">
					<mat-icon>search_off</mat-icon>
					<p>No se encontraron encargados que coincidan con "{{ searchText }}"</p>
				</div>
			</div>
		</div>
		} @else {
		<!-- Estado Vacío -->
		<div class="empty-state">
			<div class="empty-icon">
				<mat-icon>admin_panel_settings</mat-icon>
			</div>
			<h2>No hay encargados de Sucursal</h2>
			<p>Para tener encargados de Sucursal, primero debes crear sucursales y asignarles usuarios.</p>
			<button mat-raised-button class="primary-btn" (click)="navigateToBranches()">
				<mat-icon>add_business</mat-icon>
				Crear Sucursal
			</button>
		</div>
		}
	</div>

	<!-- Modal de Detalles -->
	@if (isModalOpen() && selectedSubAdmin()) {
	<div class="modal-backdrop visible" (click)="closeModal()">
		<div class="modal-container" (click)="$event.stopPropagation()">
			<header class="modal-header">
				<h2>
					<mat-icon>account_circle</mat-icon>
					Detalles del Enc. Sucursal
				</h2>
				<button mat-icon-button class="close-button" (click)="closeModal()">
					<mat-icon>close</mat-icon>
				</button>
			</header>

			<div class="modal-content">
				<div class="details-grid">
					<!-- Información Personal -->
					<div class="detail-section">
						<h3>
							<mat-icon>person</mat-icon>
							Información Personal
						</h3>
						<div class="detail-row">
							<span class="detail-label">Nombre completo:</span>
							<span class="detail-value">{{ selectedSubAdmin()?.name }} {{ selectedSubAdmin()?.lastName
								}}</span>
						</div>
						<div class="detail-row">
							<span class="detail-label">Email:</span>
							<span class="detail-value">{{ selectedSubAdmin()?.email }}</span>
						</div>
						<div class="detail-row">
							<span class="detail-label">Teléfono Celular:</span>
							<span class="detail-value">{{ selectedSubAdmin()?.phone }}</span>
						</div>
					</div>

					<!-- Documentación -->
					<div class="detail-section">
						<h3>
							<mat-icon>badge</mat-icon>
							Documentación
						</h3>
						<div class="detail-row">
							<span class="detail-label">Tipo de documento:</span>
							<span class="detail-value">{{ selectedSubAdmin()?.documentType }}</span>
						</div>
						<div class="detail-row">
							<span class="detail-label">Número de documento:</span>
							<span class="detail-value">{{ selectedSubAdmin()?.documentNumber }}</span>
						</div>
					</div>

					<!-- Sucursal -->
					<div class="detail-section">
						<h3>
							<mat-icon>business</mat-icon>
							Sucursal Asignada
						</h3>
						<div class="detail-row">
							<span class="detail-label">Sucursal:</span>
							<span class="detail-value">{{ selectedSubAdmin()?.branch }}</span>
						</div>
					</div>
				</div>

				<footer class="modal-actions">
					<button mat-stroked-button (click)="closeModal()">
						<mat-icon>close</mat-icon>
						Cerrar
					</button>
				</footer>
			</div>
		</div>
	</div>
	}
</div>
